<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'>
<title>로그인</title>
<style type="text/css">
body{
  font-family: '맑은 고딕', sans-serif;
}
#sidebar {
  color: white;
  padding: 10px 5px;
  float: left;
  margin: 5px 5px 5px 0px;
  font-weight: bold;
}

#sidebar a {
  color: white;
  text-decoration: none;
}

#content {
  margin-left: 200px;
}

#footer {
  clear: left;
}

</style>
</head>
<body>

<div id='header' style='background-color: gray; height: 60px; position:relative;'></div>

<div id='sidebar' style='background-color: orange; width: 180px; height: 400px;'>

</div><div id="content"> 
<h1>로그인</h1>
<form>
<table border='1'>
<tr>
  <th>회원 유형</th>
  <td>
    <input type='radio' name='user-type' value='student' checked>학생
    <input type='radio' name='user-type' value='teacher'>강사
    <input type='radio' name='user-type' value='manager'>운영자
  </td>
</tr>
<tr><th>이메일</th><td><input id='email' type='text' placeholder='예)hong@test.com'></td></tr>
<tr><th>암호</th><td><input id='password' type='password'></td></tr>
<tr><th></th><td><input id='save-email' type='checkbox'>이메일 저장</td></tr>
</table>
<button id='login-btn' type='button'>로그인</button>
</form>
</div>

<div id='footer' style='background-color: gray; height: 30px; margin-top: 20px;'></div>

<script src="../js/bit.js"></script>
<script src="../js/common.js"></script>
<script>
document.querySelector('#login-btn').onclick = function() {
	// 이메일 저장dl 체크되어 있으면 쿠키에 저장하고,
	// 체크되어 있지 않으면 쿠키에서 제거한다.
	if (document.querySelector('#save-email').checked) {
    setCookie('email', document.querySelector('#email').value, 30);
  } else {
	  setCookie('email', '', 0);
    //setCookie('email', '', 0, '/bitcamp-project-web2/auth');
  }
	
	var param = {
			email: document.querySelector('#email').value,
			password: document.querySelector('#password').value
	};
	var userTypeList = document.querySelectorAll('input[name=user-type]');
	for (var i = 0; i < userTypeList.length; i++) {
		if (userTypeList[i].checked) {
			param.userType = userTypeList[i].value;
			break;
		}
	}
	console.log(param);
	post('login.json', param, function(jsonText) {
		var ajaxResult = JSON.parse(jsonText);
		if (ajaxResult.status == "success") {
			location.href="../student/main.html";
			return;
		}
		
		alert(ajaxResult.data);
	});
}

// email 쿠키가 있다면 값을 넣는다.
document.querySelector('#email').value = getCookie('email').replace(/"/g, '');

</script>

</body>
</html>
